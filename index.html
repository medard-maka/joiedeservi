<!DOCTYPE html>
<html>

<head>
    <title>Affichage de l'ID RFID</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div class="container">
        <table id="records-table">
            <thead>
                <tr>
                    <th>ID1</th>
                    <th>ID2</th>
                    <th>ID3</th>
                    <th>ID4</th>
                    <th>ID5</th>
                    <th>ID6</th>
                </tr>
            </thead>
            <tbody id="records-body"></tbody>
        </table>
    </div>

    <script>
        // Paramètres ThingSpeak
        var channelId = 2572384;
        var apiKey = "BGMFDPDQNOKGCHYQ";
        var fieldIds = [1, 2, 3, 4, 5, 6]; // Champs où sont stockés les ID

        // Variable pour stocker les enregistrements
        var records = [];

        // Fonction pour récupérer et afficher les ID
        function updateRecords() {
            var promises = [];
            for (var i = 0; i < fieldIds.length; i++) {
                var fieldId = fieldIds[i];
                var promise = $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/" + fieldId + "/last.json?api_key=" + apiKey, function(data) {
                    var newRecord = {};
                    newRecord["id" + data.field] = data.field1;
                    records.push(newRecord);
                    updateRecordsTable();
                }).fail(function() {
                    console.error("Erreur lors de la récupération des données pour le champ", fieldId);
                });
                promises.push(promise);
            }
            $.when.apply($, promises).done(function() {
                // Traitement supplémentaire si nécessaire
            });
        }

        function updateRecordsTable() {
            var tbody = $("#records-body");
            tbody.empty();

            records.forEach(function(record) {
                var row = $("<tr>");
                for (var i = 1; i <= fieldIds.length; i++) {
                    row.append($("<td>").text(record["id" + i] || ""));
                }
                tbody.append(row);
            });
        }

        // Mise à jour des ID toutes les 5 secondes
        setInterval(updateRecords, 5000);
    </script>
</body>

</html>
