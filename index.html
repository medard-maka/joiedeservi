<!DOCTYPE html>
<html>

<head>
    <title>Affichage de l'ID RFID</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div class="container">
        <table id="records-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Field1</th>
                    <th>Field2</th>
                    <th>Field3</th>
                    <th>Field4</th>
                    <th>Field5</th>
                    <th>Field6</th>
                </tr>
            </thead>
            <tbody id="records-body"></tbody>
        </table>
    </div>

    <script>
        // Paramètres ThingSpeak
        var channelId = 2572384;
        var apiKey = "BGMFDPDQNOKGCHYQ";
        var fieldIds = [1, 2, 3, 4, 5, 6]; // Champs où sont stockés les ID

        // Variable pour stocker les enregistrements
        var records = [];

        // Fonction pour récupérer et afficher les ID
        function updateRecords() {
            var promises = [];
            for (var i = 0; i < fieldIds.length; i++) {
                var fieldId = fieldIds[i];
                var promise = $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/" + fieldId + "/last.json?api_key=" + apiKey, function(data) {
                    records.push({
                        id: "ID" + (records.length + 1),
                        field1: data.field1,
                        field2: data.field2,
                        field3: data.field3,
                        field4: data.field4,
                        field5: data.field5,
                        field6: data.field6
                    });
                    updateRecordsTable();
                }).fail(function() {
                    console.error("Erreur lors de la récupération des données pour le champ", fieldId);
                });
                promises.push(promise);
            }
            $.when.apply($, promises).done(function() {
                // Traitement supplémentaire si nécessaire
            });
        }

        function updateRecordsTable() {
            var tbody = $("#records-body");
            tbody.empty();

            records.forEach(function(record) {
                var row = $("<tr>");
                row.append($("<td>").text(record.id));
                row.append($("<td>").text(record.field1));
                row.append($("<td>").text(record.field2));
                row.append($("<td>").text(record.field3));
                row.append($("<td>").text(record.field4));
                row.append($("<td>").text(record.field5));
                row.append($("<td>").text(record.field6));
                tbody.append(row);
            });
        }

        // Mise à jour des ID toutes les 5 secondes
        setInterval(updateRecords, 5000);
    </script>
</body>

</html>
