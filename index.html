<!DOCTYPE html>
<html>

<head>
    <title>Affichage de l'ID RFID</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div class="container">
        <table id="records-table">
            <thead>
                <tr>
                    <th>ID 1</th>
                    <th>ID 2</th>
                    <th>ID 3</th>
                    <th>ID 4</th>
                    <th>ID 5</th>
                    <th>ID 6</th>
                </tr>
            </thead>
            <tbody id="records-body"></tbody>
        </table>
    </div>

    <script>
        // Paramètres ThingSpeak
        var channelId = 2572384;
        var apiKey = "BGMFDPDQNOKGCHYQ";
        var fieldIds = [1, 2, 3, 4, 5, 6]; // Champs où sont stockés les ID

        // Variable pour stocker les enregistrements
        var records = [];

        // Fonction pour récupérer et afficher les ID
        function updateRecords() {
            $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/1/last.json?api_key=" + apiKey, function(data1) {
                $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/2/last.json?api_key=" + apiKey, function(data2) {
                    $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/3/last.json?api_key=" + apiKey, function(data3) {
                        $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/4/last.json?api_key=" + apiKey, function(data4) {
                            $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/5/last.json?api_key=" + apiKey, function(data5) {
                                $.getJSON("https://api.thingspeak.com/channels/" + channelId + "/fields/6/last.json?api_key=" + apiKey, function(data6) {
                                    var newRecord = {
                                        id1: data1.field1,
                                        id2: data2.field1,
                                        id3: data3.field1,
                                        id4: data4.field1,
                                        id5: data5.field1,
                                        id6: data6.field1
                                    };
                                    records.push(newRecord);
                                    updateRecordsTable();
                                });
                            });
                        });
                    });
                });
            });
        }

        function updateRecordsTable() {
            var tbody = $("#records-body");
            tbody.empty();

            records.forEach(function(record) {
                var row = $("<tr>");
                row.append($("<td>").text(record.id1));
                row.append($("<td>").text(record.id2));
                row.append($("<td>").text(record.id3));
                row.append($("<td>").text(record.id4));
                row.append($("<td>").text(record.id5));
                row.append($("<td>").text(record.id6));
                tbody.append(row);
            });
        }

        // Mise à jour des ID toutes les 5 secondes
        setInterval(updateRecords, 5000);
    </script>
</body>